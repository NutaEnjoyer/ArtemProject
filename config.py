from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton
from models import User

import re

BOT_TOKEN = "7711412652:AAGidxb29rfpdbi0lDDhHPdbLsf2PZJJ35Y"  # Bot Token
ADMINS_ID = [866023953, 5922769257, 5344758315] # ID of the admin user

PHOTO_URL = "https://sun9-43.userapi.com/impg/x5LD1r8-v0RvxAN6V3GCusQvU7XjVLi11yqZVw/JuQTjJkDkjw.jpg?size=818x558&quality=95&sign=2d3f7acea3f5ab88c9294be54daad7de&type=album"


GREETING_TEXT = """<i><b>‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ÄÀóÀèÀã‡ºª ö‚ô°…û‡º∫ÀéÀäÀó
–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å , —Ç—É—Ç —Ç—ã –º–æ–∂–µ—à—å –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏ –º–æ–π VIP /–ø—Ä–∏–≤–∞—Ç–∏–∫ !! ü§ç</b>

üíå —Ç—ã –ø–æ–ª—É—á–∏—à—å –¥–æ—Å—Ç—É–ø –∫ –º–æ–µ–º—É —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ–º—É –∫–æ–Ω—Ç–µ–Ω—Ç—É 18+ , –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ —Å–≤–æ–±–æ–¥–Ω–æ–º –¥–æ—Å—Ç—É–ø–µ !

ÔªøÔªøüíå —Ç–∞–∫ –∂–µ –±—É–¥–µ—Ç —Å—Å—ã–ª–æ—á–∫–∞ –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å–æ –º–Ω–æ–π –ª–∏—á–Ω–æ , –ø–æ–¥–ø–∏—Å—ã–≤–∞–π—Å—è –∏ –Ω–∞–ø–∏—à–∏ –º–Ω–µ</i>"""

SEMI_MESSAGE = "–ß—Ç–æ–±—ã –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å —Ç–∞—Ä–∏—Ñ–æ–º, –≤—ã–±–µ—Ä–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π, –Ω–∞–∂–∞–≤ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–Ω–æ–ø–∫—É"

class Tariff:
    def __init__(self, title, price, price_usd, about, resources):
        self.title = title
        self.price = price
        self.price_usd = price_usd
        self.about = about
        self.resources = resources


TARIFFS = [
    Tariff(
        title = "‚≠êÔ∏è –ü–†–û–ë–ù–´–ô VIP", price = 300, price_usd =3.5, about = "—ç—Ç–æ—Ç –∫–∞–Ω–∞–ª, –¥–ª—è —Ç–µ—Ö –∫—Ç–æ —Å–æ–º–Ω–µ–≤–∞–µ—Ç—Å—è, —Ç—É—Ç —Ç—ã —Å–º–æ–∂–µ—à—å –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –º–µ–Ω—è –Ω–∞ –≤–∫—É—Å üëÖ", resources = " ‚Ä¢ ‚≠êÔ∏è –ü–†–û–ë–ù–´–ô VIP - –∫–∞–Ω–∞–ª"
    ),
    Tariff(
        title = "üî• –ü–†–ï–ú–ò–£–ú VIP", price = 2400, price_usd = 260, about = """<i>—Ç—É—Ç –≤—Å–µ –º–æ–∏ —Ç–∞–π–Ω—ã–µ –∏3–≤—Ä–∞—â–µ–Ω–∏9, –º–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è

–ø–æ–ª—É—á–∏—à—å –æ—Ç –º–µ–Ω—è –ø—Ä–∏—è—Ç–Ω—ã–π –±–æ–Ω—É—Å –∑–∞ –ø–æ–¥–ø–∏—Å–∫—É –≤ –≤–∏–¥–µ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ–π —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏–∏ –∏–ª–∏ –≤–∏–¥–µ–æ üî•</i>""", resources = " ‚Ä¢ üî• –ü–†–ï–ú–ò–£–ú VIP - –∫–∞–Ω–∞–ª"
    ),
    Tariff(
        title = "üëë –≠–ö–°–ö–õ–Æ–ó–ò–í VIP", price = 6000, price_usd =70, about = """<i>—Ç—É—Ç –≤—Å–µ –º–æ–∏ —Ç–∞–π–Ω—ã–µ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –∏3–≤—Ä–∞—â–µ–Ω–∏9, –º–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è

—Ç–µ–±—è –∂–¥–µ—Ç –º–æ–∏ –ø—Ä–∏—è—Ç–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã —Å –ø–æ–¥—Ä—É–≥–∞–º–∏ –∏ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏ –∏ –º–Ω–æ–≥–æ –¥—Ä—É–≥–æ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ üòõ —Ç–æ–ª—å–∫–æ –¥–ª—è –∏—Å—Ç–∏–Ω–Ω—ã—Ö —à–∞–ª—É–Ω–æ–≤

–ø–æ–ª—É—á–∏—à—å –æ—Ç –º–µ–Ω—è –ø—Ä–∏—è—Ç–Ω—ã–π –±–æ–Ω—É—Å –∑–∞ –ø–æ–¥–ø–∏—Å–∫—É –≤ –≤–∏–¥–µ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ–π —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏–∏ –∏–ª–∏ –≤–∏–¥–µ–æ üî•</i>""", resources = " ‚Ä¢ üëë –≠–ö–°–ö–õ–Æ–ó–ò–í VIP - –∫–∞–Ω–∞–ª"
    ),
    Tariff(
        title = "üîû –í–ò–†–¢", price = 1800, price_usd =20, about = """<b>–î–æ—Ä–æ–≥–æ–π, –º—ã –º–æ–∂–µ–º –ø—Ä–æ–≤–µ—Å—Ç–∏ –í–∏—Ä—Ç –≤ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —Ä–∞–∑–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö: üòõ</b>

- –ø–µ—Ä–µ–ø–∏—Å–∫–∞ —Å –º–æ–∏–º–∏ –∫—Ä—É–∂–∫–∞–º–∏ –¥–ª—è —Ç–µ–±—è 
- —É—Å—Ç—Ä–æ–∏—Ç—å –∂–∞—Ä–∫–∏–π —Ä–∞–∑–≥–æ–≤–æ—Ä –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É 
- —Å–æ–∑–≤–æ–Ω–∏—Ç—å—Å—è –ø–æ –≤–∏–¥–µ–æ""", resources = " ‚Ä¢ üîû –í–ò–†–¢ - –∫–∞–Ω–∞–ª"
    ),
]


requisites = {
    "card": "2204240129569432",
    "usdt": "EQBSjuWXqDtrisVtYDYJrX70Xf-SzTtRR-qgaUwAYCBJ29KD"
}


def STAT_TEXT():
    user = User.select()
    return f"""–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {len(user)}"""


def MAIL_TEXT():
    return f"""–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏"""


def MAIL_STAT_MESSAGE(suc, err):
    return f"""<b>–£—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: {suc}</b>
<b>–ù–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: {err}</b>"""

def tariff_text(tariff: Tariff):
    return f"""
<b>–¢–∞—Ä–∏—Ñ: {tariff.title}</b>

<b>–°—Ç–æ–∏–º–æ—Å—Ç—å: <s>{tariff.price * 2}</s>  {tariff.price} </b>üá∑üá∫RUB

<b>–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è: </b> –±–µ—Å—Å—Ä–æ—á–Ω–æ

<b>–í—ã –ø–æ–ª—É—á–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ —Å–ª–µ–¥—É—é—â–∏–º  —Ä–µ—Å—É—Ä—Å–∞–º: 
{tariff.resources}</b>

{tariff.about}
"""

def tariff_pay_text(tariff: Tariff):
    return f"""
<b>–¢–∞—Ä–∏—Ñ: {tariff.title}</b>

<b>–°—Ç–æ–∏–º–æ—Å—Ç—å: <s>{tariff.price * 2}</s>  {tariff.price} </b>üá∑üá∫RUB

<b>–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è: </b> –±–µ—Å—Å—Ä–æ—á–Ω–æ

<b>–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:</b>"""

def crypto_pay_text(tariff: Tariff, user_id: int):
    return f"""–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã: <b>–ö—Ä–∏–ø—Ç–∞ üí∞USDT</b>
–ö –æ–ø–ª–∞—Ç–µ: <b>{tariff.price}üá∑üá∫RUB</b>
–í–∞—à ID: <b>{user_id}</b>
–†–µ–∫–≤–µ–∑–∏—Ç—ã –¥–ª—è –æ–ø–ª–∞—Ç—ã:

USDT

{requisites["usdt"]}

‚ö†Ô∏è –°–µ—Ç–∏ TRC 20 –∏–ª–∏ TON 

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–≤–æ–¥–∞ —Å–∫—Ä–∏–Ω –ø—Ä–∏—Å—ã–ª–∞—Ç—å –≤ –±–æ—Ç–∞

1$ = 90‚ÇΩ
_______________________________
<i>–í—ã –ø–ª–∞—Ç–∏—Ç–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º—É –ª–∏—Ü—É.
–î–µ–Ω—å–≥–∏ –ø–æ—Å—Ç—É–ø—è—Ç –Ω–∞ —Å—á–µ—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª—è.</i>"""



def card_pay_text(tariff: Tariff, user_id: int):
    return f"""–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã: <b>–ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞ üí≥</b>
–ö –æ–ø–ª–∞—Ç–µ: <b>{tariff.price}üá∑üá∫RUB</b>
–í–∞—à ID: <b>{user_id}</b>
–†–µ–∫–≤–µ–∑–∏—Ç—ã –¥–ª—è –æ–ø–ª–∞—Ç—ã:

üìå <i>–ö–∞—Ä—Ç–∞:</i> {requisites["card"]}

‚ùóÔ∏è –ü–µ—Ä–µ–≤–æ–¥–∏—Ç–µ —Å—É–º–º—É —É–∫–∞–∑–∞–Ω–Ω—É—é –≤ —Ç–∞—Ä–∏—Ñ–µ –∏ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–≤–æ–¥–∞ —Å–∫—Ä–∏–Ω –ø—Ä–∏—Å—ã–ª–∞—Ç—å –≤ –±–æ—Ç–∞
_______________________________
<i>–í—ã –ø–ª–∞—Ç–∏—Ç–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º—É –ª–∏—Ü—É.
–î–µ–Ω—å–≥–∏ –ø–æ—Å—Ç—É–ø—è—Ç –Ω–∞ —Å—á–µ—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª—è.</i>"""


def requests_photo():
    return f"""üíÅüèª‚Äç‚ôÇÔ∏è –û–ø–ª–∞—Ç–∏–ª–∏?

üëåüèª –¢–æ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å—é–¥–∞ –∫–∞—Ä—Ç–∏–Ω–∫–æ–π (–Ω–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–º!) –∫–≤–∏—Ç–∞–Ω—Ü–∏—é –ø–ª–∞—Ç–µ–∂–∞: —Å–∫—Ä–∏–Ω—à–æ—Ç –∏–ª–∏ —Ñ–æ—Ç–æ.

–ù–∞ –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —á–µ—Ç–∫–æ –≤–∏–¥–Ω—ã: –¥–∞—Ç–∞, –≤—Ä–µ–º—è –∏ —Å—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞.
______
–ó–∞ —Å–ø–∞–º –≤—ã –º–æ–∂–µ—Ç–µ –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã!"""

def get_photo():
    return f"""‚úÖ –ö–≤–∏—Ç–∞–Ω—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É.

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–∂–∏–¥–∞–π—Ç–µ. –ë–æ—Ç –≤–∞–º —Å–æ–æ–±—â–∏—Ç –æ–± —É—Å–ø–µ—à–Ω–æ–º –ø–ª–∞—Ç–µ–∂–µ."""

def admin_text(tariff_id: int, username, user_id, user_first_name):
    tariff = TARIFFS[tariff_id]
    return f"""<b>–¢–∞—Ä–∏—Ñ: {tariff.title}

–°—Å—ã–ª–∫–∞: @{username}
ID: {user_id}
–ò–º—è: {user_first_name}</b>"""

def tariffs_menu_keyboard():
    keys = []
    for i in range(len(TARIFFS)):  # –í–∫–ª—é—á–∞–µ–º –≤—Å–µ —Ç–∞—Ä–∏—Ñ—ã
        keys.append([InlineKeyboardButton(text=TARIFFS[i].title, callback_data=f"tariff_{i}")])  # –°–ø–∏—Å–∫–∏ —Å–ø–∏—Å–∫–æ–≤

    return InlineKeyboardMarkup(inline_keyboard=keys)


def tariff_keyboard(tariff_id: int):
    return InlineKeyboardMarkup(
        inline_keyboard=[
            [InlineKeyboardButton(text="üí≥ –û–ø–ª–∞—Ç–∏—Ç—å", callback_data=f"pay_{tariff_id}")],
            [InlineKeyboardButton(text="üëà –ù–∞–∑–∞–¥", callback_data=f"back")],
        ]
    )

def tariff_pay_keyboard(tariff_id: int):
    return InlineKeyboardMarkup(
        inline_keyboard=[
            [InlineKeyboardButton(text="–ö—Ä–∏–ø—Ç–∞ üí∞", callback_data=f"crypto_pay_{tariff_id}")],
            [InlineKeyboardButton(text="–ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞ üí≥", callback_data=f"card_pay_{tariff_id}")],
            [InlineKeyboardButton(text="üëà –ù–∞–∑–∞–¥", callback_data=f"back_to_tariff_{tariff_id}")],
        ]
    )

def pay_keyboard(tariff_id: int):
    return InlineKeyboardMarkup(
        inline_keyboard=[
            [InlineKeyboardButton(text="‚è≥ –Ø –æ–ø–ª–∞—Ç–∏–ª", callback_data=f"i_pay_{tariff_id}")],
            [InlineKeyboardButton(text="üëà –ù–∞–∑–∞–¥", callback_data=f"back_to_pay_tariff_{tariff_id}")],
        ]
    )

def cancel_keyboard():
    return InlineKeyboardMarkup(
        inline_keyboard=[
            [InlineKeyboardButton(text="–û—Ç–º–µ–Ω–∞", callback_data=f"cancel")],
        ]
    )

def parse_keyboard(text: str) -> InlineKeyboardMarkup:
    """
    –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å—Ç—Ä–æ–∫—É —Ç–µ–∫—Å—Ç–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç InlineKeyboardMarkup.

    –§–æ—Ä–º–∞—Ç —Ç–µ–∫—Å—Ç–∞:
    - –ö–Ω–æ–ø–∫–∏ –≤ —Å—Ç—Ä–æ–∫–µ —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è —Å–∏–º–≤–æ–ª–æ–º |
    - –†–∞–∑–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∫–Ω–æ–ø–æ–∫ —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è —Å–∏–º–≤–æ–ª–æ–º –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ \n
    –ü—Ä–∏–º–µ—Ä:
    [–ö–Ω–æ–ø–∫–∞ 1](callback_1) | [–ö–Ω–æ–ø–∫–∞ 2](callback_2)
    [–ö–Ω–æ–ø–∫–∞ 3](callback_3)
    """
    # –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Ç–µ–∫—Å—Ç–∞ –≤–∏–¥–∞ [—Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏](callback_data)
    pattern = re.compile(r'\[(.*?)\]\((.*?)\)')

    # –†–∞–∑–±–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –ø–æ —Å—Ç—Ä–æ–∫–∞–º (–∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –∫–Ω–æ–ø–æ–∫ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ \n)
    rows = text.split('|')

    # –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ –¥–ª—è —Å—Ç—Ä–æ–∫ –∫–Ω–æ–ø–æ–∫
    inline_keyboard = []

    for row in rows:
        # –†–∞–∑–±–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞ –∫–Ω–æ–ø–∫–∏ –ø–æ —Å–∏–º–≤–æ–ª—É "|"
        buttons = []
        for button_text in row.split(','):
            match = pattern.findall(button_text.strip())
            if match:
                # –ö–∞–∂–¥–∞—è –∫–Ω–æ–ø–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ [—Ç–µ–∫—Å—Ç](callback_data)
                for button_data in match:
                    button_text, callback_data = button_data
                    buttons.append(InlineKeyboardButton(text=button_text.strip(), callback_data=callback_data.strip()))

        if buttons:
            # –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫—É –∫–Ω–æ–ø–æ–∫ –≤ –∏—Ç–æ–≥–æ–≤—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—Ç—Ä–æ–∫—É
            inline_keyboard.append(buttons)

    return InlineKeyboardMarkup(inline_keyboard=inline_keyboard)

def is_valid_keyboard_format(text: str) -> bool:
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –º–æ–∂–Ω–æ –ª–∏ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å —Ç–µ–∫—Å—Ç –∫–∞–∫ –æ–±—ä–µ–∫—Ç InlineKeyboardMarkup.

    –§–æ—Ä–º–∞—Ç:
    - –ö–Ω–æ–ø–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ [–¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏](callback_data)
    - –ö–Ω–æ–ø–∫–∏ –≤ —Å—Ç—Ä–æ–∫–µ —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è —Å–∏–º–≤–æ–ª–æ–º |
    - –°—Ç—Ä–æ–∫–∏ —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è —Å–∏–º–≤–æ–ª–æ–º –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ \n

    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç True, –µ—Å–ª–∏ —Ç–µ–∫—Å—Ç –º–æ–∂–Ω–æ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å, –∏–Ω–∞—á–µ False.
    """
    # –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Ç–µ–∫—Å—Ç–∞ –≤–∏–¥–∞ [—Ç–µ–∫—Å—Ç](callback_data)
    pattern = re.compile(r'\[(.*?)\]\((.*?)\)')

    # –†–∞–∑–±–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –Ω–∞ —Å—Ç—Ä–æ–∫–∏ (–∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –∫–Ω–æ–ø–æ–∫ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ \n)
    rows = text.split('\n')

    for row in rows:
        # –†–∞–∑–±–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞ –∫–Ω–æ–ø–∫–∏ –ø–æ —Å–∏–º–≤–æ–ª—É |
        buttons = row.split('|')

        for button in buttons:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–∞–∂–¥–∞—è –∫–Ω–æ–ø–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —à–∞–±–ª–æ–Ω—É [—Ç–µ–∫—Å—Ç](callback_data)
            match = pattern.fullmatch(button.strip())
            if not match:
                print(button)
                return False  # –ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∫–Ω–æ–ø–∫–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —à–∞–±–ª–æ–Ω—É, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º False

    return True
